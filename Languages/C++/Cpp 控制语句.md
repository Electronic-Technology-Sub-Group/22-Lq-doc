---
状态: 未完成
未完成部分: 异常类
---
# 选择语句

选择语句包含 `if` 和 `switch` 语句。

## if

语法：
- `[属性] if [constexpr] ( [初始化语句] 条件 ) true分支语句`
- `[属性] if [constexpr] ( [初始化语句] 条件 ) true分支语句 else false分支语句`
- `[属性] if [!]constexpr true分支语句`
- `[属性] if [!]constexpr true分支语句 else false分支语句`

其中
- 属性：详见[[Cpp 编译期3#属性]]
- 初始化语句：自 C++17 开始，允许在 if 条件语句之前增加一条初始化语句（表达式语句、简单声明、结构化绑定或别名声明）
- 条件：返回 `bool` 或可隐式转换成 `bool` 类型的表达式语句

## switch

`[属性] switch ( [初始化语句] 条件 ) 标签语句`

- 属性与初始化语句 与 `if` 相同
- 标签语句：`case 常量表达式: 语句` 或 `default: 语句`

# 循环语句

- `[属性] while ( 条件表达式 ) 语句（循环体）`
- `[属性] do 语句 while ( 条件表达式 ) 语句（循环体）`
- `[属性] for ( 初始化语句 [条件]; [迭代表达式] ) 语句（循环体）`
	- 也可以表示为：`[属性] for ( [声明或表达式]; [声明或表达式]; [表达式] ) 语句（循环体）`
- `[属性] for ( [初始化语句] 范围变量声明 : 范围表达式 ) 语句（循环体）`
	- 范围变量声明：范围表达式指定的类型声明，常用 `auto` 推导
	- 范围表达式：返回数组或定义了 `begin()` 与 `end()` 的可迭代对象

# 跳转语句

- `break;`：跳出一层循环，或一个 `case` 分支
- `continue;`：跳转到循环体末尾（即跳过本次循环剩下的代码）
- `return [表达式];`：对函数的返回
	- `co_return [表达式];`：对协程函数的返回
- `[属性] goto 标号;`：无条件跳转到指定标号
	- `标号: ` ：带标签语句，在某处定义一个标号标签
	- 限制：
		- 不能跨函数跳转
		- 不能跳转进 `try` 或 `catch` 块内（但可以从中跳转出）
		- 跳转跨度中不能有非平凡构造、析构等函数

# 异常处理

`try-catch` 结构构成 C++ 异常处理，表示异常处理块中的捕获块，实现处理错误状态的代码与正常代码分开

```c++
try {
    // do something
} catch (const std::exception &e) {
    // do something
} catch (const std::exception&) {
    // do something
} catch (...) {
    // do something
}
```

```ad-danger
注意：异常处理不应替代程序中应有的数据检查和验证，异常处理带来的系统开销相当大
```

可捕获的类型不应是以下类型及其数组，引用和指针：
- 除 `void` 外的不完整类型
	- `void` 类型
	- 已声明但未定义的类
	- 边界未定的数组
	- 枚举类型未声明完成之前
	- 不完整类型的数组
- 抽象类类型
- 右值引用

当我们不关心具体的异常值时，异常变量可省略（示例第二个 `catch` 块）

当我们使用 `...` 作为捕获变量时，表示该块可以捕获任意类型的异常

# 产生异常

`catch`中可直接使用 `throw` 重新抛出未捕获的异常

# 异常类

内存申请相关的异常为 `new` 头文件中的 `bad_alloc&` 类型

MFC 异常为 `CException*` 类型，并使用 `Delete()` 方法释放

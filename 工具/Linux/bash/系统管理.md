# 服务

Linux 中开机自启的软件一般称为服务，可通过 `systemctl`​ 管理

```bash
systemctl start|stop|status|enable|disable 服务名
```

* start：启动
* stop：关闭
* status：状态查询
* enable：开启开机自启
* disable：关闭开机自启

主要的系统内置服务包括：
* NetworkManager：主网络服务
* network：副网络服务
* firewalld：防火墙服务
* sshd：ssh服务
# 进程

每一个程序对应至少一个进程，每一个进程都有一个唯一编号称为 pid
## ps

使用 `ps`​ 可以查看当前进程

```bash
ps [-e] [-f]
```

* ​`-e`​：显示所有进程，否则只显示当前用户的进程
* ​`-f`​：以完全格式化的形式展示，显示全部信息
​![[Pasted image 20240806165244.png]]​

* ​`UID`​：进程所属用户 ID
* ​`PID`​：进程 id
* ​`PPID`​：进程的父进程 id
* ​`C`​：CPU 占用率（百分比）
* ​`STIME`​：进程启动时间
* ​`TTY`​：启动进程的终端号，`?`​ 表示非终端启动
* ​`TIME`​：进程占用 CPU 时间
* ​`CMD`​：进程的启动路径或启动命令
## kill

kill 用于结束进程

```
kill [-9] 进程ID
```

* ​`-9`​：强制关闭进程
# 状态监控
## top

该命令用于查看 CPU、内存占用率，默认每 5s 刷新一次

```bash
top [options]
```

* ​`-p 进程id`​：只显示某个进程信息
* ​`-u 用户`​：只显示某个用户的进程信息
* ​`-d 间隔`​：刷新时间，单位 s，默认 5s
* ​`-c`​：COMMAND 列显示产生进程的完整命令，默认进程名
* ​`-n 次数`​：指定刷新次数，刷新 n 次后 top 自动关闭
* ​`-b`​：以非交互模式运行，一般配合 `-n`​ 将输出重定向到某个文件
* ​`-i`​：不显示闲置和僵尸进程（状态为 I 或 Z）
### 显示信息

​![[Pasted image 20240806165302.png]]​

* 第一行 top - 系统时间 up 系统运行时间, 登录用户数, 系统平均负载: 1min, 5min, 15min
* 第二行 Tasks 总进程数，运行中的进程数，睡眠中的进程数，已停止进程数，僵尸进程数
* 第三行 CPU 使用率
    * **us**，**sy**：用户、系统 CPU 使用率
    * ni：高优先级进程占用 CPU 时间百分比
    * id：空闲 CPU 率
    * wa：IO 等待 CPU 占用率
    * hi，si：CPU 硬件、软件中断率
    * st：强制等待占用 CPU 率
* 第四、五行：内存使用率
    * **Mem**，Swap：物理内存、虚拟内存（交换空间）
    * **total**，**free**，**used**，buffer/cache：总量，空闲，已使用，buffer和cache占用（系统缓存）
* 下方列表：当前进程列表
    * PR：优先级，越小越高
    * NI：以 0 为基准的优先级，正表示低于标准
    * VIRT：使用的虚拟内存，单位 KB
    * RES：使用的物理内存，单位 KB
    * SHR：使用的共享内存，单位 KB
    * S：状态，R 表示运行，S 休眠，Z 僵死，I 空闲，N 负优先级
    * %CPU：CPU 占用率
    * %MEM：内存占用率
    * TIME+：使用 CPU 时间总计，单位 10ms
    * COMMAND：启动命令或程序路径
### 快捷键

|按键|作用|
| ------| ---------------------------------------|
|h|帮助|
|c|显示完整命令（开启、关闭 -c 选项）|
|i|不显示无用进程（开启、关闭 -i 选项）|
|f|选择展示项目|
|M|根据驻留内存排序（%MEM 列）|
|P|根据 CPU 使用率排序（%CPU 列）|
|T|根据运行时间/累计时间排序（TIME+ 列）|
|e|切换顶部内存信息使用单位|
|E|切换进程内存信息使用单位|
|l|切换显示平均负载和启动时间|
|t|切换显示 CPU 状态信息|
|m|切换显示内存信息|
|q|退出、返回上层（h、f 等）|
## df

查看应哦按使用情况

```bash
df [-h]
```

* -h：以更人性化的形式展示

​![[Pasted image 20240806165335.png]]​
## iostat

用于查看 CPU、磁盘的详细监控指标，该命令位于 `sysstat`​ 包中

```bash
iostat [-x] [刷新间隔] [刷新次数]
```

​`-x`​：显示更多信息
​![[Pasted image 20240806165400.png]]​

* rKB/s：每秒发送到设备的读取请求数
* wKB/s：每秒发送到设备的写入请求数
* %util：磁盘利用率
## sar -n DEV

固定写法，监控网络状态

```
sar -n DEV [刷新间隔] [刷新次数]
```

第一次使用提示无法打开 `/var/log/sa/saXX`​，使用 `sar -o XX`​ 创建对应文件即可。

​![[Pasted image 20240806165413.png]]​

* IFACE：本地网卡接口名称
* ​`[r|t]x[...]/s`​：r 代表接收，t 代表发送，表示每秒钟发送或接收的某种数据包
    * pck：数据包
    * KB：KB 为单位的数据包大小（实时网速）
    * cmp：压缩数据包
    * mcst：多播数据包
# 环境变量

* PATH：命令搜索，等效于 Windows 同名环境变量

系统环境变量存放在 `/etc/profile`​ 文件中，用户环境变量存放在 `~/.bashrc`​ 文件中，多条变量以 `:`​ 分割

**注意：自定义环境变量时不要忘记添加本身存在的环境变量**

```
export PATH=%PATH:自定义环境变量...
```
## env

查看当前系统环境变量
## export

在当前 bash 上下文中设置环境变量（临时）

```bash
export 变量名=变量值
```
## source

从文件加载环境变量，也可以在修改 `~/.bashrc`​ 文件后执行该命令使之快速生效

```bash
source 修改的文件名
```

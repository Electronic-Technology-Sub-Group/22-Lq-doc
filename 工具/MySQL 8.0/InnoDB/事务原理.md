![[Pasted image 20240807233534.png]]
# 重做日志

redo log，记录事务提交时数据页的物理修改，实现事务的持久性

![[Pasted image 20240807233547.png]]

当事务提交之后，所有修改信息会记录到重做日志中，用于刷新脏页到磁盘发生错误时进行数据恢复
* 将 redo log 写入磁盘是事务的一部分，写入失败会造成事务失败
* 不直接将数据写入磁盘而是写入日志，主要由于日志写入是追加，不涉及到随机 IO 操作，性能更高
# 回滚日志

undo log，记录数据被修改前的信息，提供回滚和 MVCC，保证数据库原子性

与 redo log 不同的是，redo log 记录了新数据的数据内容，属于物理日志；undo log 记录了与执行的操作相反的 SQL 语句，属于逻辑日志。当我们执行 `rollback`​ 时，可以方便的从 undo log 中找到相应内容并回滚。

undo log 在事务执行时产生，事务提交后不会立即删除，当不涉及 MVCC 后再删除。

undo log 以段方式记录和管理，存放于 rollback segment，内包含 1024 个 undo log segment。

分库分表主要解决数据库数据量过大时，产生的以下问题：

* IO 瓶颈
    * 热点数据太多，数据库缓存不足，产生大量磁盘 IO
    * 请求数据过多，产生网络 IO
* CPU 瓶颈：排序、分组、联查、聚合等 SQL 消耗大量 CPU 资源

>[!note] 分库分表：将存储于单台服务器中的数据分散的存储到多台服务器中，缓解单一服务器的性能瓶颈
# 拆分策略

根据拆分维度分为垂直拆分和水平拆分，根据拆分粒度分为分库和分表
## 垂直分库

以表为依据，根据业务将不同表拆分到不同数据库中，以缓解单个库数据过于庞大、访问过于频繁的问题
* 每个库的表结构不同
* 每个库的数据不同
* 全部数据为所有库的并集

![[Pasted image 20240807234416.png]]
## 垂直分表

以字段为依据，根据字段属性将不同字段拆分到不同表中，以缓解单个表数据过于庞大、访问过于频繁的问题
* 每个表的表结构不同
* 每个表的数据不同，通常通过一列主键或外键相关联
* 全部表数据为所有表的并集

![[Pasted image 20240807234427.png]]
## 水平分库

以字段为依据，按一定策略将一个库拆分到多个库中
* 每个库的表结构相同
* 每个库的数据不同
* 全部数据为所有库的并集

![[Pasted image 20240807234441.png]]
## 水平分表

以字段为依据，按一定策略将一个表拆分到多个表中
* 每个表的表结构相同
* 每个表的数据不同
* 全部表数据为所有表的并集

![[Pasted image 20240807234453.png]]
# 读写分离

读写分离基于主从数据库，将数据库读写操作分开对应不同数据库服务器。主数据库提供写操作，从数据库提供读操作。

MySQL 的读写分离也通过 MyCat，同时支持 Oracle 和 SQL Server 等

# 实现

目前主要的实现技术有两个

* shardingJDBC：基于 AOP，在应用程序中对 SQL 进行拦截、解析、改写、路由，只支持 Java，性能较高
* MyCat：数据库中间件，根据数据库请求进行改写和路由，性能不及前者

‍

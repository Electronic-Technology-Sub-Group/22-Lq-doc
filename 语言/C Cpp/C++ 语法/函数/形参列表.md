# å½¢å‚åˆ—è¡¨

>[!note] å½¢å‚ï¼šå‡½æ•°å¤´å’Œå‡½æ•°åŸå‹çš„å½¢å‚åˆ—è¡¨ä¸­çš„å‚æ•°ï¼Œå½¢å‚ä¸ä¼šåˆ†é…å¯¹åº”å†…å­˜ç©ºé—´

>[!note] å®å‚ï¼šå®é™…è°ƒç”¨å‡½æ•°æ—¶ä¼ å…¥çš„å‚æ•°

å½¢å‚åˆ—è¡¨æ˜¯å‡½æ•°ä½“ä¸­è¡¨ç¤ºå‡½æ•°å‚æ•°çš„éƒ¨åˆ†ã€‚

```c++
int func(int a, float b, double c, size_t d) {
    // do something
}
```

ä¸éœ€è¦ä»»ä½•å‚æ•°æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ `void` å¡«å……å½¢å‚åˆ—è¡¨ï¼Œæˆ–ç•™ç©º

```c++
void no_parameter_fun1() {
    // do something
}

void no_parameter_fun2(void) {
    // do something
}
```
# å½¢å‚é»˜è®¤å€¼

å½¢å‚å…è®¸ä½¿ç”¨é»˜è®¤å€¼ï¼Œå¸¦æœ‰é»˜è®¤å€¼çš„å½¢å‚å¿…é¡»åœ¨æ™®é€šå‚æ•°ä¹‹å

```c++
void fun(int a, double b, long c = 5L, bool d = false);
```
# å˜é•¿å‚æ•°

å‡½æ•°å¯ä»¥æ¥å—ä¸å®šé•¿åº¦çš„ğŸ‡¨å‚æ•°ï¼Œç§°ä¸ºå˜é•¿å‚æ•°ã€‚

å‡½æ•°å‚æ•°åˆ—è¡¨å¯ä»¥ä½¿ç”¨ `...` ç»“å°¾ï¼Œè¡¨ç¤ºæ¥å—å˜é•¿å‚æ•°ï¼Œä½†æœ‰ä¸€äº›é™åˆ¶
* å‡½æ•°è‡³å°‘æœ‰ä¸€ä¸ªæ™®é€šå½¢å‚
* å¯é€‰å‚æ•°å¿…é¡»åœ¨æ‰€æœ‰å‚æ•°æœ«å°¾ä¸”åªèƒ½æœ‰ä¸€ä¸ª
* ä¸èƒ½æŒ‡å®šå¯é€‰å‚æ•°çš„ç±»å‹

ä¸å®šå‚æ•°é€šè¿‡ `cstdarg` å¤´æ–‡ä»¶çš„ `va_start`, `va_arg`, `va_end` è®¿é—®

# æ˜¾å¼ this å‚æ•°
#cpp23 

C++ æ ‡å‡†ä¸­ï¼Œéé™æ€æˆå‘˜å‡½æ•°å†…å¯è®¿é—®ä¸€ä¸ª `this`ï¼Œè¯¥æŒ‡é’ˆé€šå¸¸è¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªéšå¼ä¼ å…¥çš„å‚æ•°ï¼Œå‡½æ•°åç½®çš„ä¿®é¥°ç¬¦å°±æ˜¯è¯¥å‚æ•°çš„ä¿®é¥°ç¬¦

```c++
struct X {
    // fun1(const X *this)
    void fun1() const {}
    // fun2(volatile X&& *this)
    void fun2(int i) volatile &&{}
};
```

C++23 å…è®¸å‡½æ•°ç¬¬ä¸€ä¸ªå‚æ•°ä½¿ç”¨ `this` ä¿®é¥°ï¼Œè¡¨ç¤ºè¯¥å˜é‡å³ `this` å‚æ•°ï¼Œè°ƒç”¨æ—¶ä¸éœ€è¦æ˜¾å¼ä¼ å…¥ã€‚ç±»ä¼¼ `python` çš„ `self`ã€‚

ä½†è¿™æ ·çš„å‡½æ•°ä¾¿ä»æˆå‘˜å‡½æ•°å˜æˆäº†é™æ€å‡½æ•°
* å‡½æ•°ä½“å†… `this` ä¸å†å¯ç”¨ - ä½†æœ‰äº† `this` ç»‘å®šçš„å‚æ•°å˜é‡ä»£æ›¿
* ä¸å…è®¸ `static`ï¼Œ`virtual`ï¼Œ`cv` é™å®šç¬¦

```c++
struct X {
    void fun1(this const X &self) {}
    void fun2(this volatile X &&self, int i) {}
};
```

å› æ­¤ï¼Œé€‚ç”¨äºå½¢å‚çš„ä¸€äº›æŠ€å·§ä¾¿å¯ä»¥ç›´æ¥åº”ç”¨åˆ° `this` ä¸Šï¼š
* æ¨¡æ¿
* å¯ä»¥ä¸å¿…è¦æ˜¯ä¸€ä¸ªæŒ‡é’ˆæˆ–å¼•ç”¨ï¼Œä¹Ÿå¯ä»¥æ˜¯å¯¹è±¡ï¼ˆé€‚ç”¨äº `string_view` ç­‰ï¼‰
* é€’å½’ lambdaï¼š`lambda` æ˜¯å¸¦ `operator()` çš„åŒ¿åç±»ï¼Œå¯ä»¥è®©ç¬¬ä¸€ä¸ªå‚æ•°ä¸º `this auto self`

```c++
auto fact = [](this auto self, int n) -> int {
    return n ? n * self(n - 1) : 1; 
}
```

---
语言: cpp
语法类型: 中级语法
---
`[]` 中直接输入变量表示捕获列表，默认使用按值捕获，即将变量值复制一份传入。

按值捕获实际上类似于 `static const` 修饰的局部变量，不是函数参数。且复制传入的初值是在声明时对应变量的值，与调用时值无关。带有 `mutable` 修饰时则类似于不带 `const` 修饰符。

```cpp
int main() {
    int a = 99;
    // a 捕获的值为 99
    auto f = [a]() mutable { cout << (a++) << '\n'; };

    a = 0;
    f(); // 99，a=100

    a = 1;
    f(); // 100，a=101

    a = 2;
    f(); // 101，a=102

    return 0;
}
```

使用 `&` 表示该变量为引用捕获，捕获的是外部对象的引用。无论是否带有 `mutable` 该引用均可以被修改。

```cpp
int main() {
    int a = 99;
    auto f = [&a]() { cout << (a++) << '\n'; };

    a = 0;
    f(); // 0
    cout << a << '\n'; // 1
    a = 10;
    f(); // 10
    cout << a << '\n'; // 11
    a = 20;
    f(); // 20
    cout << a << '\n'; // 21

    return 0;
}
```

按值捕获和引用捕获可以混用，还有一些特殊的捕获方式：
* `[this]`：捕获 `this` 指针
* `[=]`：以按值捕获的形式，捕获 lambda 表达式所在作用域的所有变量值，包括 this
* `[&]`：以引用捕获的形式，捕获 lambda 表达式所在作用域的所有变量值，包括 this

`[=]`，`[&]` 后可以与带变量名的按值捕获、引用捕获连用，表示除后面这些变量外其他所有变量值以给定方式捕获。

还可以在捕获时对某些值进行处理，称为[[广义捕获]]。